---
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';
import Layout from '../layouts/layout.astro';

export async function getStaticPaths() {
  const projects = await getCollection('projects');
  return projects.map((project) => ({
    params: {
      slug: project.slug,
    },
    props: {
      project,
    },
  }));
}

const { project } = Astro.props;
const { Content } = await project.render();
---

<Layout title={`${project.data.title} - Christoph Saile`}>
  <main>
    <article class='flex flex-col gap-10'>
      <Image src={project.data.cover} alt='' />
      <div class='flex flex-col gap-y-20'>
        <section
          class='grid lg:grid-cols-[1fr_2fr] gap-10 lg:gap-x-0 lg:gap-y-20'
        >
          <div class='flex flex-col'>
            <h1>
              <a href={project.data.url}>{project.data.title}</a>
            </h1>
            <span>Date: {project.data.year}</span>
          </div>
          <p class='hyphens-auto'>{project.data.description}</p>
        </section>
        <div class='flex flex-col gap-y-20'>
          <Content />
        </div>
      </div>
    </article>
  </main>
</Layout>

<style is:global>
  .section {
    @apply grid md:grid-cols-[1fr_2fr];
  }
  .section-text {
    @apply flex flex-col gap-2 hyphens-auto;
  }
  h1 {
    @apply text-4xl font-bold;
  }
  h2 {
    @apply text-2xl font-bold mb-4 md:mb-0;
  }
  p:has(img) {
    @apply md:col-span-2;
  }
</style>
